#clear
set verbose off

include logging.gfn
include multiplot.gfn
include pca_biplot.inp

set workdir "/home/artur/git/pca_biplot"

EXAMPLE = 4

if EXAMPLE == 1
    open mrw.gdt --quiet
    list X = gdp60 gdp85 inv
elif EXAMPLE == 2
    open griliches.gdt --quiet
    list X = med iq age s #expr lw
elif EXAMPLE == 3
    #open griliches.gdt --quiet
    open "/home/artur/Universit√§t/Kurse_Eigene/THB/oekonometrie_kurse/common/code/ISL/Credit.csv" -q
    list X = Income Rating Cards #Age #Education Region
elif EXAMPLE == 4
    #open griliches.gdt --quiet
    open "../data/world-happiness-report-2021.csv" -q

    # Rename series
    rename Socialsupport social
    rename Healthylifeexpectancy life
    rename Freedomtomakelifechoices choices
    rename Generosity generosity
    rename Perceptionsofcorruption corruption

    list X = social life choices generosity corruption
    markers --from-series=Regionalindicator
endif

smpl X --no-missing
#smpl obs < 25 --restrict


bundle P = pcaTools(X)
print P
pcaPrint(P)
pcaScreePlot(P)


# TODO: add variable 'n_pcs_to_plot' to limit the PC to plot
# Biplot options
series P.factor = Regionalindicator
#scalar P.cols_biplot = 2
scalar P.n_pcs_to_plot = 3
scalar P.transparency = 99
pcaBiplot(P)

